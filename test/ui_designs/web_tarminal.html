<style>
.tarminal{
  background-color: black;
  color: white;
}
</style>
<script>
_onload = function(e){
  const KEY_NAME = {
    ENTER: 13,
    BACKSPACE: 8,
    ARROW_LEFT: 37,
    ARROW_UP: 38,
    ARROW_RIGHT: 39,
    ARROW_DOWN: 40,
  };
  const tarminal_dom = document.querySelector(".tarminal");
  let commit_cursor = 0;
  const getCurrent = ()=>tarminal_dom.selectionStart;
  const isBefore = curr=>curr<commit_cursor;
  const setCursor = v=>tarminal_dom.setSelectionRange(v, v);
  const setCancel = e=>e.preventDefault();

  tarminal_dom.addEventListener('keydown',function(e){
    const _input = e.keyCode;
    const _current = getCurrent();

    if(_input==KEY_NAME["ENTER"]){
      //tarminal_dom.value = tarminal_dom.value+'$';
      commit_cursor = _current+1;
    }else if(_input==KEY_NAME["BACKSPACE"]){
      if(isBefore(_current-1)){
        setCursor(commit_cursor);
        setCancel(e);
      }
    }else if(_input>=KEY_NAME["ARROW_LEFT"] && _input<=KEY_NAME["ARROW_DOWN"]){
      if(_input==KEY_NAME["ARROW_UP"] || _input==KEY_NAME["ARROW_DOWN"]){
        setCancel(e);
      }else if(_input==KEY_NAME["ARROW_LEFT"]){
        if(isBefore(_current-1)) setCancel(e);
      }
    }
  });
  tarminal_dom.addEventListener('click',function(e){
    const _current = getCurrent();
    if(isBefore(_current-1)) setCursor(commit_cursor);
  });
};
window.onload = _onload;
</script>

<p style="overflow-y: scroll;">
1. Enterを押したら、確定カーソル位置を更新してコマンドを送信<br>
2. 確定カーソル位置以下なら、Backspaceをさせない<br>
3. 確定カーソル位置以下なら、カーソル移動をさせない<br>
</p>
<hr>
<textarea class="tarminal"></textarea>
