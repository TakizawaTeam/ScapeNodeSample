<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/105/three.min.js"></script>
</head>
<body>
  <canvas id="myCanvas"></canvas>

  <script>
  const canvas = document.querySelector('#myCanvas');

  let moveX=0, moveY=0;
  canvas.addEventListener("click",function(e){ canvas.requestPointerLock(); });
  canvas.addEventListener("mousemove",function(e){
    if(document.pointerLockElement === canvas){
      moveX = e.movementX;
      moveY = e.movementY;
      console.log(`x: ${e.movementX}, y: ${e.movementX}`);
    }else{
      moveX = 0;
      moveY = 0;
    }
  });

  const config = {
    screen: {
      size: {width: 480, height: 320},
    },
  };
  let scene = null;
  let camera = null;
  let box = null;
  function initialize(){
    scene = new THREE.Scene();
    camera = new THREE.PerspectiveCamera(45, config.screen.size.width / config.screen.size.height);
    camera.position.set(0, 0, +1000);

    const geometry = new THREE.BoxGeometry(500, 500, 500);
    const material = new THREE.MeshNormalMaterial();
    box = new THREE.Mesh(geometry, material);
    scene.add(box);
  }
  function drawframe(render){
    //box.rotation.y += 0.01;
    camera.rotation.y += (moveX>5 ? 5 : moveX) / (100 + 0);
    camera.rotation.x += (moveY>5 ? 5 : moveY) / (100 + 0);
    moveX = 0;
    moveY = 0;

    render.render(scene, camera); //描画
  }

  window.addEventListener('load', init);
  function init(){
    const render = new THREE.WebGLRenderer({canvas: canvas});
    render.setPixelRatio(window.devicePixelRatio);
    render.setSize(config.screen.size.width, config.screen.size.height);

    initialize();
    frame();
    function frame(){
      drawframe(render);
      requestAnimationFrame(frame); //アニメーション処理実行
    }
  };
  </script>
</body>
