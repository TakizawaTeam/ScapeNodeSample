<HEAD>
  <TITLE>WorkSpace / ScapeNode</TITLE>
  <meta charset="UTF-8"/>
</HEAD>
<BODY style="margin:0px;">
  <script>
  const protocpl = 'ws';
  const host = this.location.host;
  const page = 'repl';
  const url = `${protocpl}://${host}/${page}`;

  let server = null;
  let opened = false;
  let history = [];
  let history_size = 50;
  const ask = q=>(opened&&!!server? server.send(q) : null);
  window.onload = function(){
    server = new WebSocket(url);
    server.onmessage = function(e){
      m=e.data.split("\n"); m.pop(); m=m.join("\n"); //prompt削除
      history.push(m); console.log(m); //保存及び出力
      history=history.slice(-history_size); //最大件数
    };
    server.onopen = function(e){opened=true; console.log(`${url} connected!`);};
    server.onclose = function(e){opened=false; console.log(`${url} disconnected!`);};
  };
  </script>

  <style>
  .modal{
    position: absolute;
    left: 0px;
    top: 0px;
    background-color: rgba(0,0,0,0.3);
    width: 100%;
    height: 100%;
    z-index: 9999;
  }
  #CommandPalette .window{
    position: relative;
    left: 50%;
    top: 10px;
    transform: translateX(-50%);
    background-color: #404550;
    max-width: 480px;
    min-width: 240px;
    height: 480px;
    border-radius: 5px;
    padding: 10px;
  }
  #CommandPalette .command{
    color: #EEE;
    background-color: #303440;
    border: none;
    width: 100%;
    margin-bottom: 10px;
    padding-left: 5px;
    font-size: 14px;
    height: 25px;
  }
  #CommandPalette .predict{
    background-color: #303440;
    height: calc(100% - 35px);
    border: solid 1px #303440;
    overflow-y: scroll;
  }
  #CommandPalette .predict .box{
    color: #CCD;
    background-color: #404550;
    border-bottom: solid 1px #303440;
    height: 30px;
    padding-left: 10px;
    line-height: 30px;
  }
  #CommandPalette .predict .box:hover{
    background-color: #505660;
  }
  </style>

  <div id="main">
    <div id="CommandPalette" class="modal">
      <div class="window">
        <input type="text" class="command"/>
        <div class="predict">
          <div class="box">dummyA</div>
          <div class="box">dummyB</div>
          <div class="box">dummyC</div>

          <div class="box">dummy1</div>
          <div class="box">dummy2</div>
          <div class="box">dummy3</div>
          <div class="box">dummy4</div>
          <div class="box">dummy5</div>
          <div class="box">dummy6</div>
          <div class="box">dummy7</div>
          <div class="box">dummy8</div>
          <div class="box">dummy9</div>
          <div class="box">dummy10</div>
          <div class="box">dummy11</div>
          <div class="box">dummy12</div>
          <div class="box">dummy13</div>
          <div class="box">dummy14</div>
          <div class="box">dummy15</div>
        </div>
      </div>
    </div>
    <!--<div id="PathFinder" class="modal">
    </div>-->
  </div>
</BODY>
