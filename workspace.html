<HEAD>
  <TITLE>WorkSpace / ScapeNode</TITLE>
  <meta charset="UTF-8"/>
</HEAD>
<BODY style="margin:0px;">
  <script>
  const protocpl = 'ws';
  const host = this.location.host;
  const page = 'repl';
  const url = `${protocpl}://${host}/${page}`;

  let server = null;
  let opened = false;
  let history = [];
  let history_size = 50;
  const ask = q=>(opened&&!!server? server.send(q) : null);
  window.onload = function(){
    server = new WebSocket(url);
    server.onmessage = function(e){
      m=e.data.split("\n"); m.pop(); m=m.join("\n"); //prompt削除
      history.push(m); console.log(m); //保存及び出力
      history=history.slice(-history_size); //最大件数
    };
    server.onopen = function(e){opened=true; console.log(`${url} connected!`);};
    server.onclose = function(e){opened=false; console.log(`${url} disconnected!`);};
  };
  </script>

  <div id="main">
    <div id="CommandPalette">
      <div class="modal"/>
    </div>
    <div id="PathFinder">
      <div class="modal"/>
    </div>
  </div>
</BODY>
